#### Packaging setup for OGS-6 ####

if(APPLE AND CMAKE_INSTALL_PREFIX MATCHES "/usr/local")
	set(CMAKE_INSTALL_PREFIX "/Applications")
endif()

SET(CPACK_PACKAGE_DESCRIPTION_SUMMARY "OGS-6")
SET(CPACK_PACKAGE_VENDOR "OpenGeoSys Community (http://www.opengeosys.com)")
SET(CPACK_PACKAGE_INSTALL_DIRECTORY "OGS-${OGS_VERSION_MAJOR}.${OGS_VERSION_MINOR}.${OGS_VERSION_PATCH}")
SET(CPACK_PACKAGE_DESCRIPTION_FILE "${CMAKE_SOURCE_DIR}/README.md")
SET(CPACK_RESOURCE_FILE_LICENSE "${CMAKE_SOURCE_DIR}/LICENSE.txt")
SET(CPACK_PACKAGE_VERSION_MAJOR "${OGS_VERSION_MAJOR}")
SET(CPACK_PACKAGE_VERSION_MINOR "${OGS_VERSION_MINOR}")
SET(CPACK_PACKAGE_VERSION_PATCH "${OGS_VERSION_PATCH}")
SET(CPACK_PACKAGE_FILE_NAME "ogs-${OGS_VERSION}-${CMAKE_SYSTEM}-x${BITS}")

IF(MSVC)

ELSEIF(APPLE)
	set(CPACK_GENERATOR "DragNDrop")
	set(CPACK_DMG_FORMAT "UDBZ")
	set(CPACK_DMG_VOLUME_NAME "${PROJECT_NAME}")
	set(CPACK_SYSTEM_NAME "OSX")
	set(CPACK_PACKAGE_FILE_NAME "${PROJECT_NAME}-${OGS_VERSION}")
ELSE()

ENDIF()

INCLUDE (CPack)
return()

IF (OGS_PACKAGING_ZIP)
	SET (CPACK_GENERATOR ZIP)
	SET(CPACK_PACKAGE_FILE_NAME "ogs-6")
ELSE (OGS_PACKAGING_ZIP)
	IF(WIN32)
		SET(CPACK_GENERATOR NSIS)
		# There is a bug in NSI that does not handle full unix paths properly. Make
		# sure there is at least one set of four (4) backlasshes.
		#SET(CPACK_PACKAGE_ICON "${CMAKE_SOURCE_DIR}/CMakeConfiguration\\\\OGS_Logo_Installer.bmp")
		#SET(CPACK_NSIS_INSTALLED_ICON_NAME "bin\\\\MyExecutable.exe")
		SET(CPACK_NSIS_DISPLAY_NAME "${CPACK_PACKAGE_DESCRIPTION_SUMMARY}")
		SET(CPACK_NSIS_HELP_LINK "https:\\\\\\\\www.opengeosys.org")
		SET(CPACK_NSIS_URL_INFO_ABOUT "http:\\\\\\\\www.opengeosys.org")
		SET(CPACK_NSIS_CONTACT "info@opengeosys.org")
		SET(CPACK_NSIS_MODIFY_PATH ON)
		# SET(CPACK_NSIS_MENU_LINKS "http://www.opengeosys.org" "OGS Project Page")
		# SET(CPACK_NSIS_MENU_LINKS "http://www.opengeosys.org/forum/" "OGS forum")
		# SET(CPACK_NSIS_MENU_LINKS "https://github.com/ufz/ogs" "OGS source code")
		# SET(CPACK_NSIS_MENU_LINKS "http://devguide.opengeosys.org" "OGS developer guide")
		MESSAGE (STATUS "Packaging set to NSIS")
	ELSE(WIN32)
		IF(UNIX)
			SET(CPACK_GENERATOR TGZ)
		ELSE(UNIX)
			IF(APPLE)
		SET(CPACK_GENERATOR TGZ)
			ENDIF(APPLE)
		ENDIF(UNIX)
		#SET(CPACK_STRIP_FILES "bin/ogs")
		#SET(CPACK_SOURCE_STRIP_FILES "")
	ENDIF(WIN32)
ENDIF (OGS_PACKAGING_ZIP)

# INCLUDE (FindMSVCRedist)
# IF (MSVC_REDIST)
# 	SET(CPACK_COMPONENTS_ALL msvc_redist)
# ENDIF () # MSVC_REDIST

SET(CPACK_COMPONENT_OGS_DISPLAY_NAME "Executable")
SET(CPACK_COMPONENT_OGS_DESCRIPTION "The command line executable")
SET(CPACK_COMPONENT_MSVC_REDIST_DISPLAY_NAME "C++ Redistributable")
SET(CPACK_COMPONENT_MSVC_REDIST_DESCRIPTION "Microsoft Visual C++ Redistributable")

SET(CPACK_COMPONENTS_ALL_IN_ONE_PACKAGE 1)
IF (OGS_BUILD_GUI)
	SET(CPACK_PACKAGE_EXECUTABLES "ogs-gui" "OGS User Interface")
	SET(CPACK_COMPONENTS_ALL ${CPACK_COMPONENTS_ALL} ogs_gui Unspecified)
	SET(CPACK_COMPONENT_OGS_GUI_DISPLAY_NAME "Data Explorer")
	SET(CPACK_COMPONENT_OGS_GUI_DESCRIPTION "The graphical user interface for OpenGeoSys")
	#SET(CPACK_COMPONENT_OGS_GUI_DEPENDS ogs)
ELSE ()
	# SET(CPACK_PACKAGE_EXECUTABLES "ogs" "OGS Command Line")
	# SET(CPACK_COMPONENTS_ALL ${CPACK_COMPONENTS_ALL} ogs Unspecified)
ENDIF ()

INCLUDE (CPack)
