<?xml version="1.0" encoding="ISO-8859-1"?>
<OpenGeoSysProject>
    <meshes>
        <mesh>domain.vtu</mesh>
        <mesh>boundary_left.vtu</mesh>
        <mesh>boundary_right.vtu</mesh>
    </meshes>
    <processes>
        <process>
            <name>TRM</name>
            <type>THERMO_RICHARDS_MECHANICS</type>
            <mass_lumping>true</mass_lumping>
            <integration_order>2</integration_order>
            <constitutive_relation>
                <type>LinearElasticIsotropic</type>
                <youngs_modulus>E</youngs_modulus>
                <poissons_ratio>nu</poissons_ratio>
            </constitutive_relation>
            <process_variables>
                <temperature>temperature</temperature>
                <pressure>pressure</pressure>
                <displacement>displacement</displacement>
            </process_variables>
            <secondary_variables>
                <secondary_variable name="sigma"/>
                <secondary_variable name="epsilon"/>
                <secondary_variable name="velocity"/>
                <secondary_variable name="saturation"/>
            </secondary_variables>
            <specific_body_force>0 0</specific_body_force>
        </process>
    </processes>
    <media>
        <!-- Some parameters are mutiplied with a time factor of 86400
        in order to set the time unit as day. -->
        <medium id="0">
            <phases>
                <phase>
                    <type>Gas</type>
                    <properties>
                        <property>
                            <name>density</name>
                            <type>WaterVapourDensity</type>
                        </property>
                        <property>
                            <name>diffusion</name>
                            <type>VapourDiffusionFEBEX</type>
                        </property>
                        <property>
                            <name>thermal_diffusion_enhancement_factor</name>
                            <type>Constant</type>
                            <value>1.0</value>
                        </property>
                        <property>
                            <name>specific_heat_capacity</name>
                            <type>Constant</type>
                            <value>0</value>
                        </property>
                    </properties>
                </phase>
                <phase>
                    <type>AqueousLiquid</type>
                    <properties>
                        <property>
                            <name>specific_heat_capacity</name>
                            <type>Constant</type>
                            <value>4280</value>
                        </property>
                        <property>
                            <name>density</name>
                            <type>Constant</type>
                            <value>1000</value>
                        </property>
                        <property>
                            <name>thermal_expansivity</name>
                            <type>Constant</type>
                            <value>0.</value>
                        </property>
                        <property>
                            <name>viscosity</name>
                            <type>Constant</type>
                            <value>1e-3</value>
                        </property>
                    </properties>
                </phase>
                <phase>
                    <type>Solid</type>
                    <properties>
                        <property>
                            <name>density</name>
                            <type>Constant</type>
                            <value>1650.0</value>
                        </property>
                        <property>
                            <name>specific_heat_capacity</name>
                            <type>Linear</type>
                            <!-- 732.5/0.44 -->
                            <reference_value>1308.0357142857142</reference_value>
                            <independent_variable>
                                <variable_name>temperature</variable_name>
                                <reference_condition>273.15</reference_condition>
                                <!-- 1.38 / 732.5 -->
                                <slope>0.0018839590443686005</slope>
                            </independent_variable>
                        </property>
                        <property>
                            <name>thermal_expansivity</name>
                            <type>Constant</type>
                            <value>0.</value>
                        </property>
                    </properties>
                </phase>
            </phases>
            <properties>
                <property>
                    <name>tortuosity</name>
                    <type>Constant</type>
                    <!-- mutiplied with a time factor of 86400-->
                    <value>86400.0</value>
                </property>
                <property>
                    <name>permeability</name>
                    <type>Function</type>
                    <value>
                        <!-- mutiplied with a time factor of 86400-->
                        <expression>86400.e-11 * pow((1-0.44) /( 1- 0.44 * exp(-7.0*liquid_saturation)), 2.0) *
                            pow(0.44 * exp(-7.0*liquid_saturation) /0.44, 3.0)
                        </expression>
                    </value>
                    <dvalue>
                        <variable_name>liquid_saturation</variable_name>
                        <expression>0.0</expression>
                    </dvalue>
                </property>
                <property>
                    <name>biot_coefficient</name>
                    <type>Constant</type>
                    <value>1.0</value>
                </property>
                <property>
                    <name>bishops_effective_stress</name>
                    <type>BishopsPowerLaw</type>
                    <exponent>1</exponent>
                </property>
                <property>
                    <name>saturation</name>
                    <type>Curve</type>
                    <curve>S_pc</curve>
                    <independent_variable>capillary_pressure</independent_variable>
                </property>
                <property>
                    <name>relative_permeability</name>
                    <type>Curve</type>
                    <curve>k_rel_L</curve>
                    <independent_variable>liquid_saturation</independent_variable>
                </property>
                <property>
                    <name>porosity</name>
                    <type>Constant</type>
                    <value>0.44</value>
                </property>
                <property>
                    <name>thermal_conductivity</name>
                    <type>Function</type>
                    <value>
                        <!-- mutiplied with a time factor of 86400-->
                        <expression>86400.0*(0.78 * liquid_saturation + 0.5)</expression>
                    </value>
                    <dvalue>
                        <variable_name>liquid_saturation</variable_name>
                        <expression>0.78</expression>
                    </dvalue>
                </property>
            </properties>
        </medium>
    </media>
    <time_loop>
        <processes>
            <process ref="TRM">
                <nonlinear_solver>basic_newton</nonlinear_solver>
                <convergence_criterion>
                    <type>PerComponentDeltaX</type>
                    <norm_type>NORM2</norm_type>
                    <abstols>1e-8 1e-4 1e-8 1e-8</abstols>
                    <reltols>1e-10 1e-10 1.e-8 1.e-8</reltols>
                </convergence_criterion>
                <time_discretization>
                    <type>BackwardEuler</type>
                </time_discretization>
				<time_stepping>
                    <type>FixedTimeStepping</type>
                    <!-- Time unit is day -->
                    <t_initial>0</t_initial>
                    <t_end>14.0</t_end>
                    <timesteps>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>0.0001</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>0.00018432</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>0.00071568</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>0.00429408</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>0.0147059</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>0.03</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>0.05</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>0.1</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>0.1</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>0.1</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>0.1</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>0.1</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>0.1</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>0.1</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>0.1</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>0.1</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>0.5</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>0.5</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>1</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>1</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>1</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>1</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>1</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>1</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>1</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>1</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>1</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>1</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>1</delta_t>
                        </pair>
                        <pair>
                            <repeat> 1 </repeat>
                            <delta_t>1</delta_t>
                        </pair>
                    </timesteps>
                </time_stepping>
            </process>
        </processes>
        <output>
            <type>VTK</type>
            <prefix>CTF1_</prefix>
            <timesteps>
                <pair>
                    <repeat>1</repeat>
                    <each_steps>1</each_steps>
                </pair>
            </timesteps>
            <output_iteration_results>false</output_iteration_results>
            <variables>
                <variable>pressure</variable>
                <variable>temperature</variable>
                <variable>displacement</variable>
                <variable>sigma</variable>
                <variable>epsilon</variable>
                <variable>velocity</variable>
                <variable>saturation</variable>
                <variable>pressure_interpolated</variable>
                <variable>temperature_interpolated</variable>
            </variables>
            <suffix>{:time}</suffix>
        </output>
    </time_loop>
    <parameters>
        <parameter>
            <name>E</name>
            <type>Constant</type>
            <value>1.3e6</value>
        </parameter>
        <parameter>
            <name>nu</name>
            <type>Constant</type>
            <value>0.4</value>
        </parameter>
        <parameter>
            <name>T0</name>
            <type>Constant</type>
            <value>303</value>
        </parameter>
        <parameter>
            <name>displacement0</name>
            <type>Constant</type>
            <values>0 0</values>
        </parameter>
        <parameter>
            <name>p_ic</name>
            <type>Constant</type>
            <value>-75.e6</value>
        </parameter>
        <parameter>
            <name>T_left</name>
            <type>Constant</type>
            <value>393</value>
        </parameter>
        <parameter>
            <name>dirichlet0</name>
            <type>Constant</type>
            <value>0</value>
        </parameter>
    </parameters>
    <curves>
        <curve>
            <name>k_rel_L</name>
            <coords>
                0
                0.01
                0.02
                0.03
                0.04
                0.05
                0.06
                0.07
                0.08
                0.09
                0.1
                0.11
                0.12
                0.13
                0.14
                0.15
                0.16
                0.17
                0.18
                0.19
                0.2
                0.21
                0.22
                0.23
                0.24
                0.25
                0.26
                0.27
                0.28
                0.29
                0.3
                0.31
                0.32
                0.33
                0.34
                0.35
                0.36
                0.37
                0.38
                0.39
                0.4
                0.41
                0.42
                0.43
                0.44
                0.45
                0.46
                0.47
                0.48
                0.49
                0.5
                0.51
                0.52
                0.53
                0.54
                0.55
                0.56
                0.57
                0.58
                0.59
                0.6
                0.61
                0.62
                0.63
                0.64
                0.65
                0.66
                0.67
                0.68
                0.69
                0.7
                0.71
                0.72
                0.73
                0.74
                0.75
                0.76
                0.77
                0.78
                0.79
                0.8
                0.81
                0.82
                0.83
                0.84
                0.85
                0.86
                0.87
                0.88
                0.89
                0.9
                0.91
                0.92
                0.93
                0.94
                0.95
                0.96
                0.97
                0.98
                0.99
                0.999
                0.9999
                0.99999
                0.999999
                1
            </coords>
            <values>
                0
                1E-24
                4.096E-21
                5.31441E-19
                1.67772E-17
                2.44141E-16
                2.17678E-15
                1.38413E-14
                6.87195E-14
                2.8243E-13
                1E-12
                3.13843E-12
                8.9161E-12
                2.32981E-11
                5.66939E-11
                1.29746E-10
                2.81475E-10
                5.82622E-10
                1.15683E-09
                2.21331E-09
                4.096E-09
                7.35583E-09
                1.2855E-08
                2.19146E-08
                3.65203E-08
                5.96046E-08
                9.5429E-08
                1.50095E-07
                2.32218E-07
                3.53815E-07
                5.31441E-07
                7.87663E-07
                1.15292E-06
                1.66789E-06
                2.38642E-06
                3.37922E-06
                4.73838E-06
                6.58295E-06
                9.06574E-06
                1.23816E-05
                1.67772E-05
                2.25635E-05
                3.01295E-05
                3.99596E-05
                5.26541E-05
                6.89525E-05
                8.97623E-05
                0.000116191
                0.000149587
                0.000191581
                0.000244141
                0.000309629
                0.000390877
                0.000491259
                0.000614788
                0.000766218
                0.000951166
                0.001176246
                0.001449225
                0.001779197
                0.002176782
                0.002654349
                0.003226267
                0.003909188
                0.004722366
                0.005688009
                0.006831675
                0.008182719
                0.009774779
                0.01164633
                0.013841287
                0.016409683
                0.01940841
                0.022902048
                0.026963771
                0.031676352
                0.037133262
                0.043439889
                0.05071486
                0.059091511
                0.068719477
                0.079766443
                0.092420056
                0.106890008
                0.123410307
                0.142241757
                0.163674648
                0.188031682
                0.215671156
                0.246990404
                0.282429536
                0.322475487
                0.367666388
                0.418596297
                0.475920315
                0.540360088
                0.612709757
                0.693842361
                0.784716724
                0.886384872
                0.98806578
                0.99880066
                0.999880007
                0.999988
                1
            </values>
        </curve>
        <curve>
            <name>S_pc</name>
            <coords>
                32993541195
                10647976718
                5494686811
                3436098248
                2387284340
                1772765022
                1378288405
                1108199533
                914179244.9
                769523336
                658425423.3
                571008930.4
                500825590.8
                443509711
                396013825.3
                356154423
                322331359.8
                293348711.2
                268297051.1
                246474112
                227330102.6
                210429260.3
                195422329.1
                182026538.1
                170010820.2
                159184754
                149390188.4
                140494827.1
                132387264.1
                124973104.9
                118171907.8
                111914753.8
                106142298.5
                100803202
                95852852.4
                91252322.38
                86967511.75
                82968437.78
                79228645.43
                75724714.54
                72435846.03
                69343512.94
                66431164.94
                63683976.9
                61088634.37
                58633149.63
                56306703.59
                54099509.33
                52002693.95
                50008195.97
                48108676.02
                46297438.7
                44568364.26
                42915848.51
                41334749.89
                39820342.79
                38368276.16
                36974536.81
                35635416.77
                34347484.15
                33107557.1
                31912680.45
                30760104.73
                29647267.23
                28571774.92
                27531388.9
                26524010.26
                25547667.19
                24600503.05
                23680765.45
                22786795.99
                21917020.75
                21069941.22
                20244125.65
                19438200.71
                18650843.2
                17880771.87
                17126739.01
                16387521.68
                15661912.34
                14948708.65
                14246701.89
                13554663.68
                12871330.17
                12195382.81
                11525424.32
                10859947.74
                10197295.82
                9535605.804
                8872732.355
                8206136.359
                7532718.109
                6848555.855
                6148473.073
                5425271.517
                4668243.441
                3859897.447
                2967221.695
                1908654.154
                453206.271
                108606.4381
                26050.23014
                6248.951646
                0
            </coords>
            <values>
                0.01
                0.02
                0.03
                0.04
                0.05
                0.06
                0.07
                0.08
                0.09
                0.1
                0.11
                0.12
                0.13
                0.14
                0.15
                0.16
                0.17
                0.18
                0.19
                0.2
                0.21
                0.22
                0.23
                0.24
                0.25
                0.26
                0.27
                0.28
                0.29
                0.3
                0.31
                0.32
                0.33
                0.34
                0.35
                0.36
                0.37
                0.38
                0.39
                0.4
                0.41
                0.42
                0.43
                0.44
                0.45
                0.46
                0.47
                0.48
                0.49
                0.5
                0.51
                0.52
                0.53
                0.54
                0.55
                0.56
                0.57
                0.58
                0.59
                0.6
                0.61
                0.62
                0.63
                0.64
                0.65
                0.66
                0.67
                0.68
                0.69
                0.7
                0.71
                0.72
                0.73
                0.74
                0.75
                0.76
                0.77
                0.78
                0.79
                0.8
                0.81
                0.82
                0.83
                0.84
                0.85
                0.86
                0.87
                0.88
                0.89
                0.9
                0.91
                0.92
                0.93
                0.94
                0.95
                0.96
                0.97
                0.98
                0.99
                0.999
                0.9999
                0.99999
                0.999999
                1
            </values>
        </curve>
    </curves>
    <process_variables>
        <!-- ## Displacement equation ##############################################-->
        <process_variable>
            <name>displacement</name>
            <components>2</components>
            <order>1</order>
            <initial_condition>displacement0</initial_condition>
            <boundary_conditions>
                <boundary_condition>
                    <mesh>domain</mesh>
                    <type>Dirichlet</type>
                    <component>0</component>
                    <parameter>dirichlet0</parameter>
                </boundary_condition>
                <boundary_condition>
                    <mesh>domain</mesh>
                    <type>Dirichlet</type>
                    <component>1</component>
                    <parameter>dirichlet0</parameter>
                </boundary_condition>
            </boundary_conditions>
        </process_variable>
        <!--- ## pressure equation #######################################-->
        <process_variable>
            <name>pressure</name>
            <components>1</components>
            <order>1</order>
            <initial_condition>p_ic</initial_condition>
            <boundary_conditions>
            </boundary_conditions>
        </process_variable>
        <!--- ## Temperature equation ##############################################-->
        <process_variable>
            <name>temperature</name>
            <components>1</components>
            <order>1</order>
            <initial_condition>T0</initial_condition>
            <boundary_conditions>
                <boundary_condition>
                    <mesh>boundary_right</mesh>
                    <type>Dirichlet</type>
                    <component>0</component>
                    <parameter>T0</parameter>
                </boundary_condition>
                <boundary_condition>
                    <mesh>boundary_left</mesh>
                    <type>Dirichlet</type>
                    <component>0</component>
                    <parameter>T_left</parameter>
                </boundary_condition>
            </boundary_conditions>
        </process_variable>
    </process_variables>
    <nonlinear_solvers>
        <nonlinear_solver>
            <name>basic_newton</name>
            <type>Newton</type>
            <max_iter>50</max_iter>
            <linear_solver>general_linear_solver</linear_solver>
        </nonlinear_solver>
    </nonlinear_solvers>
    <linear_solvers>
        <linear_solver>
            <name>general_linear_solver</name>
            <eigen>
                <solver_type>SparseLU</solver_type>
                <scaling>true</scaling>
            </eigen>
        </linear_solver>
    </linear_solvers>
</OpenGeoSysProject>
