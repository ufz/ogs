<?xml version="1.0" encoding="ISO-8859-1"?>
<OpenGeoSysProject>
    <meshes>
        <mesh axially_symmetric="true">restart_w_backfill_1Dq_domain_IC.vtu</mesh>
        <mesh axially_symmetric="true">restart_w_backfill_1Dq_PLY_inner.vtu</mesh>
        <mesh axially_symmetric="true">restart_w_backfill_1Dq_PLY_outer.vtu</mesh>
        <mesh axially_symmetric="true">restart_w_backfill_1Dq_PLY_upper.vtu</mesh>
        <mesh axially_symmetric="true">restart_w_backfill_1Dq_PLY_lower.vtu</mesh>
    </meshes>
    <processes>
        <process>
            <name>RM</name>
            <type>RICHARDS_MECHANICS</type>
            <integration_order>4</integration_order>

            <constitutive_relation id="2"> <!-- Rock -->
                <type>LinearElasticIsotropic</type>
                <youngs_modulus>E_Rock</youngs_modulus>
                <poissons_ratio>nu_Rock</poissons_ratio>
            </constitutive_relation>
            <constitutive_relation id="1"> <!-- EDZ -->
                <type>LinearElasticIsotropic</type>
                <youngs_modulus>E_Rock</youngs_modulus>
                <poissons_ratio>nu_Rock</poissons_ratio>
            </constitutive_relation>
            <constitutive_relation id="0"> <!-- Backfill -->
                <type>LinearElasticIsotropic</type>
                <youngs_modulus>E_Backfill</youngs_modulus>
                <poissons_ratio>nu_Backfill</poissons_ratio>
            </constitutive_relation>
            <process_variables>
                <pressure>pressure</pressure>
                <displacement>displacement</displacement>
            </process_variables>
            <secondary_variables>
                <secondary_variable internal_name="sigma" output_name="sigma"/>
                <secondary_variable internal_name="swelling_stress" output_name="swelling_stress"/>
                <secondary_variable internal_name="epsilon" output_name="epsilon"/>
                <secondary_variable internal_name="velocity" output_name="velocity"/>
                <secondary_variable internal_name="saturation" output_name="saturation"/>
                <secondary_variable internal_name="porosity" output_name="porosity"/>
                <secondary_variable internal_name="transport_porosity" output_name="transport_porosity"/>
                <secondary_variable internal_name="dry_density_solid" output_name="dry_density_solid"/>
            </secondary_variables>
            <specific_body_force>0 0</specific_body_force>
        </process>
    </processes>
    <media>
        <medium id="2">   <!-- Rock host rock -->
            <phases>
                <phase>
                    <type>AqueousLiquid</type>
                    <properties>
                        <property>
                            <name>density</name>
                            <type>Linear</type>
                            <reference_value>1000</reference_value>
                            <independent_variable>
                                <variable_name>liquid_phase_pressure</variable_name>
                                <reference_condition>12.0e06</reference_condition>
                                <slope>4.5e-10</slope>
                            </independent_variable>
                        </property>
                        <property>
                            <name>viscosity</name>
                            <type>Constant</type>
                            <value>1e-3</value>
                        </property>
                    </properties>
                </phase>
                <phase>
                    <type>Solid</type>
                    <properties>
                        <property>
                            <name>density</name>
                            <type>Constant</type>
                            <value>2700.0</value>
                        </property>
                    </properties>
                </phase>
            </phases>
            <properties>
                <property>
                    <name>permeability</name>
                    <type>Constant</type>
                    <value>2.77e-20</value>
                </property>
                <property>
                    <name>biot_coefficient</name>
                    <type>Constant</type>
                    <value>.8</value>
                </property>
                <property>
                    <name>saturation</name>
                    <type>SaturationVanGenuchten</type>
                    <residual_liquid_saturation>0.0</residual_liquid_saturation>
                    <residual_gas_saturation>0.0</residual_gas_saturation>
                    <exponent>0.33333</exponent>
                    <p_b>15.0e06</p_b>
                </property>
                <property>
                    <name>relative_permeability</name>
                    <type>RelativePermeabilityVanGenuchten</type>
                    <residual_liquid_saturation>0.0</residual_liquid_saturation>
                    <residual_gas_saturation>0.0</residual_gas_saturation>
                    <exponent>0.33333</exponent>
                    <minimum_relative_permeability_liquid>1.0e-6</minimum_relative_permeability_liquid>
                </property>
                <property>
                    <name>porosity</name>
                    <type>Constant</type>
                    <value>0.18</value>
                </property>
                <property>
                    <name>bishops_effective_stress</name>
                    <type>BishopsSaturationCutoff</type>
                    <cutoff_value>1.0</cutoff_value>
                </property>
                <property>
                    <name>reference_temperature</name>
                    <type>Constant</type>
                    <value>293.15</value>
                </property>
            </properties>
        </medium>
        <medium id="1">   <!-- Rock EDZ -->
            <phases>
                <phase>
                    <type>AqueousLiquid</type>
                    <properties>
                        <property>
                            <name>density</name>
                            <type>Linear</type>
                            <reference_value>1000</reference_value>
                            <independent_variable>
                                <variable_name>liquid_phase_pressure</variable_name>
                                <reference_condition>12.0e06</reference_condition>
                                <slope>4.5e-10</slope>
                            </independent_variable>
                        </property>
                        <property>
                            <name>viscosity</name>
                            <type>Constant</type>
                            <value>1e-3</value>
                        </property>
                    </properties>
                </phase>
                <phase>
                    <type>Solid</type>
                    <properties>
                        <property>
                            <name>density</name>
                            <type>Constant</type>
                            <value>2700.0</value>
                        </property>
                    </properties>
                </phase>
            </phases>
            <properties>
                <property>
                    <name>permeability</name>
                    <type>Constant</type>
                    <value>2.77e-18</value>
                </property>
                <property>
                    <name>biot_coefficient</name>
                    <type>Constant</type>
                    <value>1.0</value>
                </property>
                <property>
                    <name>saturation</name>
                    <type>SaturationVanGenuchten</type>
                    <residual_liquid_saturation>0.0</residual_liquid_saturation>
                    <residual_gas_saturation>0.0</residual_gas_saturation>
                    <exponent>0.375</exponent>
                    <p_b>4.5e06</p_b>
                </property>
                <property>
                    <name>relative_permeability</name>
                    <type>RelativePermeabilityVanGenuchten</type>
                    <residual_liquid_saturation>0.0</residual_liquid_saturation>
                    <residual_gas_saturation>0.0</residual_gas_saturation>
                    <exponent>0.375</exponent>
                    <minimum_relative_permeability_liquid>1.0e-6</minimum_relative_permeability_liquid>
                </property>
                <property>
                    <name>porosity</name>
                    <type>Constant</type>
                    <value>0.18</value>
                </property>
                <property>
                    <name>bishops_effective_stress</name>
                    <type>BishopsSaturationCutoff</type>
                    <cutoff_value>1.0</cutoff_value>
                </property>
                <property>
                    <name>reference_temperature</name>
                    <type>Constant</type>
                    <value>293.15</value>
                </property>
            </properties>
        </medium>
        <medium id="0">   <!-- Backfill -->
            <phases>
                <phase>
                    <type>AqueousLiquid</type>
                    <properties>
                        <property>
                            <name>density</name>
                            <type>Linear</type>
                            <reference_value>1000</reference_value>
                            <independent_variable>
                                <variable_name>liquid_phase_pressure</variable_name>
                                <reference_condition>12.0e06</reference_condition>
                                <slope>4.5e-10</slope>
                            </independent_variable>
                        </property>
                        <property>
                            <name>viscosity</name>
                            <type>Constant</type>
                            <value>1e-3</value>
                        </property>
                    </properties>
                </phase>
                <phase>
                    <type>Solid</type>
                    <properties>
                        <property>
                            <name>density</name>
                            <type>Constant</type>
                            <value>2700.0</value>
                        </property>
                    </properties>
                </phase>
            </phases>
            <properties>
                <property>
                    <name>permeability</name>
                    <type>Constant</type>
                    <value>2.0e-19</value>
                </property>
                <property>
                    <name>biot_coefficient</name>
                    <type>Constant</type>
                    <value>1.0</value>
                </property>
                <property>
                    <name>saturation</name>
                    <type>SaturationVanGenuchten</type>
                    <residual_liquid_saturation>0.0</residual_liquid_saturation>
                    <residual_gas_saturation>0.0</residual_gas_saturation>
                    <exponent>0.2592592592592593</exponent>
                    <p_b>9.7e06</p_b>
                </property>
                <property>
                    <name>relative_permeability</name>
                    <type>RelativePermeabilityVanGenuchten</type>
                    <residual_liquid_saturation>0.0</residual_liquid_saturation>
                    <residual_gas_saturation>0.0</residual_gas_saturation>
                    <exponent>0.2592592592592593</exponent>
                    <minimum_relative_permeability_liquid>1.0e-6</minimum_relative_permeability_liquid>
                </property>
                <property>
                    <name>porosity</name>
                    <type>Constant</type>
                    <value>0.3</value>
                </property>
                <property>
                    <name>bishops_effective_stress</name>
                    <type>BishopsSaturationCutoff</type>
                    <cutoff_value>1.0</cutoff_value>
                </property>
                <property>
                    <name>reference_temperature</name>
                    <type>Constant</type>
                    <value>293.15</value>
                </property>
            </properties>
        </medium>
    </media>
    <time_loop>
        <processes>
            <process ref="RM">
                <nonlinear_solver>basic_newton</nonlinear_solver>
                <convergence_criterion>
                    <type>PerComponentDeltaX</type>
                    <norm_type>NORM2</norm_type>
                    <abstols>1.0e2 1.0e-6 1.0e-6</abstols>
                    <reltols>4.0e-6 1.0e-7 1.0e-7</reltols>
                    <!--     p_cap    u_r      u_x    -->
                </convergence_criterion>
                <time_discretization>
                    <type>BackwardEuler</type>
                </time_discretization>
                <time_stepping>
                    <type>IterationNumberBasedTimeStepping</type>
                    <t_initial>10000.0</t_initial>
                    <t_end>60000</t_end>
                    <initial_dt>3500</initial_dt>
                    <minimum_dt>1800</minimum_dt>
                    <maximum_dt>1.0e7</maximum_dt>
                    <number_iterations> 1 8 20 25</number_iterations>
                    <multiplier> 1.1 1 0.95 0.75</multiplier>
                </time_stepping>
            </process>
        </processes>
        <outputs>
            <output>
                <type>VTK</type>
                <prefix>restart_w_backfill</prefix>
                <suffix>_ts_{:0>3timestep}_t_{:time}</suffix>
                <timesteps>
                    <pair>
                        <repeat>1</repeat>
                        <each_steps>5</each_steps>
                    </pair>
                </timesteps>
                <variables>
                </variables>
            </output>
        </outputs>
    </time_loop>
    <parameters>
        <!-- Mechanics -->
        <parameter>
            <name>E_Rock</name>
            <type>Constant</type>
            <value>5.24e9</value>
        </parameter>
        <parameter>
            <name>nu_Rock</name>
            <type>Constant</type>
            <value>0.26</value>
        </parameter>
        <parameter>
            <name>E_Backfill</name>
            <type>Constant</type>
            <value>0.5e9</value>
        </parameter>
        <parameter>
            <name>nu_Backfill</name>
            <type>Constant</type>
            <value>0.3</value>
        </parameter>
        <!-- Model parameters -->
        <parameter>
            <name>displacement_ic</name>
            <type>MeshNode</type>
            <field_name>displacement</field_name>
        </parameter>
        <parameter>
            <name>displacement0</name>
            <type>Constant</type>
            <values>0 0</values>
        </parameter>
        <parameter>
            <name>zero</name>
            <type>Constant</type>
            <value>0</value>
        </parameter>
        <parameter>
            <name>one</name>
            <type>Constant</type>
            <value>1.0</value>
        </parameter>
        <parameter>
            <name>pressure_bc</name>
            <type>Constant</type>
            <value>4.7e06</value>
        </parameter>
        <parameter>
            <name>pressure_ic</name>
            <type>MeshNode</type>
            <field_name>p0</field_name>
        </parameter>
    </parameters>
    <!-- ## Displacement equation #########################################-->
    <process_variables>
        <process_variable>
            <name>displacement</name>
            <components>2</components>
            <order>2</order>
            <compensate_non_equilibrium_initial_residuum>false</compensate_non_equilibrium_initial_residuum>
            <initial_condition>displacement_ic</initial_condition>
            <boundary_conditions>
                <boundary_condition>
                    <mesh>restart_w_backfill_1Dq_PLY_inner</mesh>
                    <type>Dirichlet</type>
                    <component>0</component>
                    <parameter>zero</parameter>
                </boundary_condition>
                <boundary_condition>
                    <mesh>restart_w_backfill_1Dq_PLY_outer</mesh>
                    <type>Dirichlet</type>
                    <component>0</component>
                    <parameter>zero</parameter>
                </boundary_condition>
                <boundary_condition>
                    <mesh>restart_w_backfill_1Dq_PLY_upper</mesh>
                    <component>1</component>
                    <type>Dirichlet</type>
                    <parameter>zero</parameter>
                </boundary_condition>
                <boundary_condition>
                    <mesh>restart_w_backfill_1Dq_PLY_lower</mesh>
                    <component>1</component>
                    <type>Dirichlet</type>
                    <parameter>zero</parameter>
                </boundary_condition>
            </boundary_conditions>
        </process_variable>
        <!-- ## Capillary pressure equation #######################################-->
        <process_variable>
            <name>pressure</name>
            <components>1</components>
            <order>1</order>
            <initial_condition>pressure_ic</initial_condition>
            <boundary_conditions>
                <boundary_condition>
                    <mesh>restart_w_backfill_1Dq_PLY_outer</mesh>
                    <type>Dirichlet</type>
                    <component>0</component>
                    <parameter>pressure_bc</parameter>
                </boundary_condition>
            </boundary_conditions>
        </process_variable>
    </process_variables>
    <nonlinear_solvers>
        <nonlinear_solver>
            <name>basic_newton</name>
            <type>Newton</type>
            <max_iter>25</max_iter>
            <linear_solver>general_linear_solver</linear_solver>
        </nonlinear_solver>
    </nonlinear_solvers>
    <linear_solvers>
        <linear_solver>
            <name>general_linear_solver</name>
            <eigen>
                <solver_type>SparseLU</solver_type>
                <scaling>true</scaling>
            </eigen>
        </linear_solver>
    </linear_solvers>
    <test_definition>
        <vtkdiff>
            <regex>restart_w_backfill_ts_.*.vtu</regex>
            <field>pressure_interpolated</field>
            <absolute_tolerance>2e-7</absolute_tolerance>
            <relative_tolerance>1e-14</relative_tolerance>
        </vtkdiff>
        <vtkdiff>
            <regex>restart_w_backfill_ts_.*.vtu</regex>
            <field>displacement</field>
            <absolute_tolerance>1e-14</absolute_tolerance>
            <relative_tolerance>0</relative_tolerance>
        </vtkdiff>
        <vtkdiff>
            <regex>restart_w_backfill_ts_.*.vtu</regex>
            <field>stress_avg</field>
            <absolute_tolerance>2e-7</absolute_tolerance>
            <relative_tolerance>0</relative_tolerance>
        </vtkdiff>
    </test_definition>
</OpenGeoSysProject>
